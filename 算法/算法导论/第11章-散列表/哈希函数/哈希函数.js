/*
https://www.bilibili.com/video/av34660129?from=search&seid=15378469945186961759
https://learning.nervos.org/crypto-block/3-hash.html
å“ˆå¸Œå‡½æ•°çš„ç‰¹ç‚¹:
ç‹¬ä¸€æ— äºŒ
å®Œæ•´æ€§æ ¡éªŒ
Digestæ ¡éªŒ
checksumæ ¡éªŒå€¼
FingerprintæŒ‡çº¹ 
å“ˆå¸Œå‡½æ•°çš„åˆ†ç±»:
æ™®é€šå“ˆå¸Œ
åŠ å¯†å“ˆå¸Œ Cryptographic Hash Function
CRC-32 32ä½çš„äºŒè¿›åˆ¶æ•°, è¡¨ç¤ºæˆ16è¿›åˆ¶æ˜¯8ä½, ä¾‹å¦‚L 84 fb 67 4c
Md5 32ä½16è¿›åˆ¶æ•°, åšæ•°å€¼æ ¡éªŒ
SHA256 äºŒè¿›åˆ¶256ä½, è¡¨ç¤ºæˆ16è¿›åˆ¶å°±æ˜¯64ä½
å“ˆå¸Œç®—æ³•:
åŠ å¯†ç®—æ³•(åŠ å¯†)å’Œå“ˆå¸Œç®—æ³•(å®‰å…¨æ ¡éªŒ)
MD5, SHA-1
sHA-2(ä¸€äº›äº†ç®—æ³•çš„ç»Ÿç§°), SHA-256
å®ç”¨ä¾‹å­
ç½‘ç«™æ³¨å†Œ
åŒºå—é“¾å’ŒåŠ å¯†è´§å¸
å¯†ç å­¦
*/

/* 
https://www.bilibili.com/video/av17500428?from=search&seid=6170578859109385555
å·²çŸ¥å“ˆå¸Œå‡½æ•°: H(key) = key % 7
æœ‰å†²çªæ—¶. Hi = (H(key)+di) % 7, å…¶ä¸­, di = 1, 2, 3, 4, 5, 6
*/
const hash01 = function(a) {
    let r
    let h = []
    for (let i = 0; i < a.length; i++) {
        r = a[i] % 7
        let j = 1
        while (h.includes(r)) {
            r = (r + j) % 7
            j++
        }
        h.push(r)
    }

    return h
}
let key01 = [67, 84, 18, 26, 34, 28]

console.log("æ•°ç»„ä¸­çš„å…³é”®å­—è½¬åŒ–æˆå“ˆå¸Œè¡¨ä¸º: ", hash01(key01))

/*
é™¤æ³•æ•£åˆ—æ³•:h(k)=k mod m, ä¾‹å¦‚: m=12, k=100, åˆ™h(k) = 4
console.log("é™¤æ³•æ•£åˆ—æ³•", 100 % 12)
https://www.phpfans.net/ask/MTA3ODc5MA.html
å½“åº”ç”¨é™¤æ³•æ•£åˆ—æ˜¯,è¦æ³¨æ„mçš„é€‰æ‹©.ä¾‹å¦‚, mä¸åº”æ˜¯2çš„å¹‚, å› ä¸ºå¦‚æœm = 2 ^ p, 
åˆ™h(k) å°±æ˜¯kçš„pä¸ªæœ€ä½ä½æ•°å­—ã€‚
çº¢è‰²æ ‡è®°çš„é‚£å¥è¯çœ‹ä¸æ‡‚ï¼Œ ä¸ºä»€ä¹ˆå•Šï¼Ÿ
*/
const hash02 = function (key, p) {
    // let key = 54 // äºŒè¿›åˆ¶æ•°å­—ä¸º: 110110
    // let p = 3 // äºŒè¿›åˆ¶æ•°å­—ä¸º: 11
    /* 
    54/8 = 6 ... 6, è½¬æ¢æˆäºŒè¿›åˆ¶å°±æ˜¯: 110110/1000 = 110 ... 110
    key = 110110, p = 1000,  å–æ¨¡åçš„ç»“æœå°±æ˜¯ key=110110 çš„ p=3ä¸ªæœ€ä½ä½æ•°å­—
    è¿™ä¸ªç¨‹åºåªæ˜¯éªŒè¯ç®—æ³•å¯¼è®ºä¸­çš„è¿™å¥è¯, å¹¶ä¸æ˜¯è¯æ˜
    */
    let m =  (key % (2 ** p)).toString(2)
    console.log(`äºŒè¿›åˆ¶: ${key.toString(2)} % ${(2**p).toString(2)} = ${m}; åè¿›åˆ¶: ${key} % ${2**p} = ${parseInt(m, 2)}`)
}
hash02(54, 3)
hash02(23, 3)
// ä¹˜æ³•æ•£åˆ—è¡¨
const hash03 = function (k, s, p) {
    // så€¼æ˜¯Knuthå»ºè®®çš„ç†æƒ³å€¼
    console.log("ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸")
    let a = s/2**p 
    console.log(`01, ä¾æ®Knuthå»ºè®®, å–aä¸ºå½¢å¦‚s/2^32çš„åˆ†æ•°: ${a}}`)
    let ks = k * s
    console.log(`02, é‚£ä¹ˆ, k*s = ${k} * ${s} = ${ks}`)
    let r1 = Math.trunc(ks/2**32)
    let r0 = ks % 2**32
    console.log(`03, è¿™ä¸ªå€¼=${r1}*2**32+${r0} = ${r1 * 2**32 + r0}`)
    // r0çš„14ä¸ªæœ€é«˜æœ‰æ•ˆä½, å…ˆè®¡ç®—r0çš„ä½æ•°é•¿åº¦, 14-(æ€»é•¿32-è¿™ä¸ªé•¿åº¦)
    // æ˜¯è¦è·å–çš„é•¿åº¦, ç¤ºä¾‹ä¸­14-32+25= 7, å–å‰7ä¸ªæœ‰æ•ˆä½:1000011
    // æŠŠr0çš„åé¢çš„ä½æ•°ç§»èµ°, å‰©ä¸‹å‰é¢çš„14ä½, ", r0>>18
    let h = r0>>18
    console.log(`04, å¾—åˆ°çš„å“ˆå¸Œå‡½æ•°å€¼æ˜¯: ${h}`)
    console.log("ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸ğŸ”¸")
}

hash03(123456, 2654435769, 14)